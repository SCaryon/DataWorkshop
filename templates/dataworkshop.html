<!DOCTYPE html>
<html lang="en">
<head>

    <title>DataWorkshop</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <link rel="stylesheet" href="../static/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/css/font-awesome.min.css">

    <!-- MAIN CSS -->
    <link rel="stylesheet" href="../static/css/tooplate-style.css">
    <link rel="stylesheet" href="../static/css/parallel.css">
    <link rel="stylesheet" href="../static/css/radviz.css">
    <link rel="stylesheet" href="../static/css/scatter.css">

    <link rel="stylesheet" type="text/css" href="/static/css/user.css">

</head>
<body>

<!-- MENU -->
<div class="navbar custom-navbar navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- NAVBAR HEADER -->
        <div class="navbar-header">
            <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon icon-bar"></span>
                <span class="icon icon-bar"></span>
                <span class="icon icon-bar"></span>
            </button>
            <!-- lOGO -->
            <a href="#" class="navbar-brand">DaGoo!</a>
        </div>

        <!-- MENU LINKS -->
        <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="#home" class="smoothScroll">Home</a></li>
                <li><a href="#analysis" class="smoothScroll">About</a></li>
                <li><a href="#visual_charts" class="smoothScroll">Gallery</a></li>
                <li><a href="#" class="smoothScroll">Contact us</a></li>
                <li>
                    <div style="width: 2px; height: 20px; background-color: white; margin: 15px"></div>
                </li>
                {% if user %}
                    <li class="user_img"><a class="page-scroll" href="/user/">
                        <div class="to3" style="margin-top: -10px;">
                            <div class="to2">
                                <div class="to1">
                                    <img class="to" src="/static/user/{{ user.email }}/img/user_img.jpg">
                                </div>
                            </div>
                        </div>
                    </a>
                    </li>
                    <li><a href="/login/" class="page-scroll">Quit</a></li>
                {% else %}
                    <li>
                        <a href="/login/" class="">Log in/Sign up</a>
                    </li>
                {% endif %}
                {% if user %}
                    {% if user.permission==100 %}
                        <li>
                            <a href="/admin/?manager={{ user.username }}" class="">manage</a>
                        </li>
                    {% endif %}
                {% endif %}
            </ul>
            {% if user %}
                <script>

                    var permi = '' +{{ user.permission }};
                    switch (permi) {
                        case "1":
                            $('.to3').css('background-color', '#aac4bc');
                            break;
                        case "2":
                            $('.to3').css('background-color', '#ae853b');
                            break;
                        case "3":
                            $('.to3').css('background-color', '#dfdc5d');
                            break;
                        case "100":
                            $('.to3').css('background-color', '#ede4b8');
                            break;
                        default:
                            $('.to3').css('background-color', 'white');
                    }
                </script>
            {% endif %}
        </div>

    </div>
</div>

<!-- HOME -->
<section id="home" class="parallax-section">
    <div class="overlay"></div>
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-sm-12">
                <div class="home-text">
                    <h1>Welcome to DaGoo!</h1>
                    <br>
                    <div id="upload_data_type" class="select_container">
                        Data Type: &nbsp
                        <input id="r1" type="radio" name="select" class= "dataType" checked="checked" value="Normal"> &nbsp Normal</input> &nbsp
                        <input id="r2" type="radio" name="select" class= "dataType" value="Streaming">&nbsp Streaming</input> &nbsp
                        <input id="r3" type="radio" name="select" class= "dataType" value="Geographical">&nbsp Geographical</input> &nbsp
                        <input id="r4" type="radio" name="select" class= "dataType" value="Text">&nbsp Text</input> &nbsp
                        <input id="r5" type="radio" name="select" class= "dataType" value="Graph">&nbsp Graph</input>
                    </div>

                    <input class="button_blue" id="file_path" name="file_path" type="button"
                           onclick="path.click()" value="File Upload">
                    <input type="file" id="path" style="display:none" name="csvfile"
                           onchange="file_path.value=this.value">
                    <input class="button_blue" type="button" onclick="read_file()" value="Submit">
                    <a href='/clean' style="color: white">Clean</a>
                    <ul class="section-btn">
                        <a onclick="download_report()" class="smoothScroll"><span data-hover="Analysis Report">Analysis Report</span></a>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- Video -->
    <video controls autoplay loop muted>
        <source src="../static/videos/video.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>
</section>

<!-- Analysis -->
<div id="analysis">
    <div class="section-title">
        <h1>Analysis</h1>
    </div>
    <div id="analysis_container">
        <ul class="analysis_menu" id="analysis_menu">
            <li onclick="set_mining_tab(0)" class="active_analysis_part">Attributions Analysis</li>
            <li onclick="set_mining_tab(1)">Cluster&Embedding</li>
            <li onclick="set_mining_tab(2)">Anomaly Detection</li>
            <li onclick="set_mining_tab(3)">Classification</li>
            <li onclick="set_mining_tab(4)">Regression</li>
        </ul>
        <div class="each_analysis_part" id="each_analysis_part">
            <ul id="analysis_attributions_analysis">
                <div id="analysis_attributions_analysis_svg"></div>
            </ul>
            <ul id="analysis_cluster_embedding">
                <div id="analysis_cluster_embedding_svg"></div>
                <div class="add-to-wishlist" ><a href='/cluster'>Cluster</a></div>
                <div class="quick-view"><a href='/embedding'>Embedding</a></div>
            </ul>
            <ul id="analysis_anomaly_detection">
                <div id="analysis_anomaly_detection_svg"></div>
            </ul>
            <ul id="analysis_classification">
                <div id="analysis_classification_svg"></div>
            </ul>
            <ul id="analysis_regression">
                <div id="analysis_regression_svg"></div>
            </ul>
        </div>
    </div>
</div>

<!-- Visual Charts -->
<section id="visual_charts" class="parallax-section">
    <div class="container">
        <div class="row">
    <div class="section-title">
        <h1>Visual Charts</h1>
    </div>
    <div class="visual_charts_tab">
        <input  id="one" name="visual_charts_tab" type="radio">
        <label for="one">Radviz</label>

        <input id="two" name="visual_charts_tab" type="radio" value="Two">
        <label for="two">Scatter Plot</label>

        <input checked id="three" name="visual_charts_tab" type="radio">
        <label for="three">Parallel Coordinates</label>

        <div class="panels">
            <div class="panel" id="draw_radviz">
                <div id="radviz_select_bar">
                    <!-- CENTER COLUMN -->
                    <div class="radviz_column-center">
                        <div id="visDiv"></div>
                    </div>
                    <!-- LEFT COLUMN -->
                    <div class="radviz_column-left">
                        <form action="" id="setVars" class="radviz_displayStyle">
                            <p style="margin-bottom: 10px;margin-top: 15px;" class="radviz_title">Select Variables</p>
                            <table>
                                <tbody>
                                <tr>
                                    <td id="numeric" class="radviz_selectionAlignment"></td>
                                </tr>
                                </tbody>
                            </table>
                        </form>
                        <form action="" id="setColorVar" class="radviz_displayStyle">
                            <p>Color by:</p>
                            <table>
                                <tbody>
                                <tr>
                                    <td id="colorVar" class="radviz_selectionAlignment">
                                        <g>
                                            <input type="radio" value="-1" label="None" name="colorAttribute"
                                                   checked="">
                                            <text>None</text>
                                            <p></p>
                                        </g>
                                        <g id="colorGroup"></g>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </form>
                    </div>
                </div>
            </div>
            <div class="panel" id="draw_scatter">

            </div>
            <div class="panel" id="draw_parallel">

            </div>
        </div>
        </div>
        </div>
    </div>
</section>

<!---Contact us---->
<section id="aboutus" class="parallax-section">
	<div class="container">
        <div class="row">
            <h1>About</h1>
            <h2>Dagoo</h2>
            <p style="font-family:arial;color:black;">Big data are high volume, high velocity, and high variety information assets that require new forms of processing to enable enhanced decision making, insight discovery ,process optimization and visualization.Dagoo is an a versatile platform for big data.It can solve a series of problems related to big data and artificial intelligence.It is skilled at doing fast analysis for any high-dimensional data.You don’t need to do programming.You just click the botton and you can get analysis results and know the characteristics of the data clearly.What’s more,scientist can exploit their own programme and share to our platform. </p>
	</div>
  </div>
</section>

<div class="getdata">
    <ul id="table_features">
        {% for feature in features_list %}
            <li>{{ feature }}</li>
        {% endfor %}
    </ul>
    <ul id="means">
        {% for m in mean %}
            <li>{{ m }}</li>
        {% endfor %}
    </ul>
    <ul id="medians">
        {% for m in median %}
            <li>{{ m }}</li>
        {% endfor %}
    </ul>
    <ul id="modes">
        {% for m in mode %}
            <li>{{ m }}</li>
        {% endfor %}
    </ul>
    <ul id="minimums">
        {% for m in min %}
            <li>{{ m }}</li>
        {% endfor %}
    </ul>
    <ul id="maximums">
        {% for m in max %}
            <li>{{ m }}</li>
        {% endfor %}
    </ul>
    <ul id="variances">
        {% for m in var %}
            <li>{{ m }}</li>
        {% endfor %}
    </ul>
    <ul id="get_corr_data">
        {% for m in corr %}
            <li>{{ m }}</li>
        {% endfor %}
    </ul>
    <ul id="cluster_embedding_data">
        {% for name in cluster_embedding_data %}
            <li>{{ name }}</li>
        {% endfor %}
    </ul>
    <ul id="n_clusters">
        <li>{{ n_clusters }}</li>
    </ul>
    <ul id="data_dictionary">
        {% for d in data_dictionary %}
            <li>{{ d }}</li>
        {% endfor %}
    </ul>

    <ul id="attributions_analysis_data">
        {% for name in attributions_analysis_data %}
            <li>{{ name }}</li>
        {% endfor %}
    </ul>
    <ul id="anomaly_detection_data">
        {% for name in anomaly_detection_data %}
            <li>{{ name }}</li>
        {% endfor %}
    </ul>
    <ul id="cluster_method">
        <li>{{ cluster_method }}</li>
    </ul>
    <ul id="embedding_method">
        <li>{{ embedding_method }}</li>
    </ul>
    <ul id="features_dictionary">
        {% for d in features_dictionary %}
            <li>{{ d }}</li>
        {% endfor %}
    </ul>
    <ul id="no_identifiers_data_dictionary">
        {% for d in no_identifiers_data_dictionary %}
            <li>{{ d }}</li>
        {% endfor %}
    </ul>
    <ul id="no_identifiers_data_list">
        {% for d in no_identifiers_data_list %}
            <li>{{ d }}</li>
        {% endfor %}
    </ul>
    <ul id="no_identifiers_data_list_transform">
        {% for d in no_identifiers_data_list_transform %}
            <li>{{ d }}</li>
        {% endfor %}
    </ul>
    <ul id="data_list">
        {% for d in data_list %}
            <li>{{ d }}</li>
        {% endfor %}
    </ul>
    <ul id="visualization_method">
        <li>{{ visualization_method }}</li>
    </ul>
</div>

<!-- SCRIPTS -->
<script src="../static/js/jquery.js"></script>
<script src="../static/js/bootstrap.min.js"></script>
<script src="../static/js/jquery.parallax.js"></script>
<script src="../static/js/modernizr.custom.js"></script>
<script src="../static/js/smoothscroll.js"></script>
<script src="../static/js/custom.js"></script>
<script src="../static/js/upload.js"></script>
<script src="../static/js/tab.js"></script>
<script src="https://cdn.bootcss.com/PapaParse/4.4.0/papaparse.js"></script>
<script src=" https://cdnjs.cloudflare.com/ajax/libs/jschardet/1.4.1/jschardet.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script type="text/javascript" src="http://www.xdocin.com/xdoc.js"></script>
<script type="text/javascript" src="http://www.xdocin.com/baiduTemplate.js"></script>
<script src="../static/js/parallel.js"></script>
<script src="../static/js/radviz.js"></script>
<script src="../static/js/scatter.js"></script>
<script src="../static/js/fisheye.js"></script>

<!--data-->
<script>
    features_string = "";
    means = "";
    medians = "";
    modes = "";
    minimums = "";
    maximums = "";
    variances = "";
    feature_list = new Array();
    array = document.getElementById("table_features").getElementsByTagName("li");
    for (i = 0; i < array.length; i++) {
        feature_list.push(array[i].innerHTML);
    }
    for (i = 0; i < array.length; i++) {
        features_string = features_string + '"' + array[i].innerHTML + '"' + " ";
    }
    array = document.getElementById("means").getElementsByTagName("li");
    for (i = 0; i < array.length; i++) {
        means = means + '"' + array[i].innerHTML + '"' + " ";
    }
    array = document.getElementById("medians").getElementsByTagName("li");
    for (i = 0; i < array.length; i++) {
        medians = medians + '"' + array[i].innerHTML + '"' + " ";
    }
    array = document.getElementById("modes").getElementsByTagName("li");
    for (i = 0; i < array.length; i++) {
        modes = modes + '"' + array[i].innerHTML + '"' + " ";
    }
    array = document.getElementById("minimums").getElementsByTagName("li");
    for (i = 0; i < array.length; i++) {
        minimums = minimums + '"' + array[i].innerHTML + '"' + " ";
    }
    array = document.getElementById("maximums").getElementsByTagName("li");
    for (i = 0; i < array.length; i++) {
        maximums = maximums + '"' + array[i].innerHTML + '"' + " ";
    }
    array = document.getElementById("variances").getElementsByTagName("li");
    for (i = 0; i < array.length; i++) {
        variances = variances + '"' + array[i].innerHTML + '"' + " ";
    }
    stt_data = new Array();
    stt_data.push(features_string);
    stt_data.push(means);
    stt_data.push(medians);
    stt_data.push(modes);
    stt_data.push(minimums);
    stt_data.push(maximums);
    stt_data.push(variances);
    stt_variables = ["mean", "median", "mode", "minimum", "maximum", "variance"];
    statistics_strings = "   The attributions of the dataset are " + features_string + ', and';
    for (i = 0; i < stt_variables.length; i++) {
        statistics_strings = statistics_strings + " the " + stt_variables[i] + " of them";
        statistics_strings = statistics_strings + " is " + stt_data[i + 1] + ",";
    }
    statistics_strings = statistics_strings + " as shown in the table.";

    corr_data = new Array();
    var arr = document.getElementById("get_corr_data").getElementsByTagName('li'), temp = [];
    for (i = 0; i < arr.length; i++) {
        temp.push(arr[i].innerHTML);
    }
    for (i = 0; i < temp.length; i++) {
        temp1 = temp[i].replace('[', '');
        temp2 = temp1.replace(']', '');
        temp3 = temp2.split(",");
        numArray = temp3.map((value) => {
            return parseFloat(value);
        });
        corr_data.push(numArray);
    }
    corr_strings = '';
    for (i = 0; i < feature_list.length; i++)
        for (j = i + 1; j < feature_list.length; j++) {
            if (corr_data[i][j] > 0.95) {
                corr_strings = corr_strings + '"' + feature_list[i] + '" and "' + feature_list[j] + '" are highly positive correlated-their correlations is ' + corr_data[i][j] + '. ';
            }
            if (corr_data[i][j] < -0.95) {
                corr_strings = corr_strings + '"' + feature_list[i] + '" and "' + feature_list[j] + '" are highly negative correlated-their correlations is ' + corr_data[i][j] + '. ';
            }
        }
    attributes_string = '   We computed the pairwise correlations among all attributes.';
    attributes_string = attributes_string + corr_strings;
    attributes_string = attributes_string + ' Other pairs do not show much correlations.';

    colors = ["purple", "maroon", "navy", "aqua", "lime", "sliver", "red", "yellow", "blue", "darkslategray"];
    d3Colors = d3.scale.ordinal().range(["purple", "maroon", "navy", "aqua", "lime", "sliver", "red", "yellow", "blue", "darkslategray"]);

    arr = document.getElementById("cluster_method").getElementsByTagName('li');
    cluster_method = arr[0].innerHTML;

    arr = document.getElementById("embedding_method").getElementsByTagName('li');
    embedding_method = arr[0].innerHTML;

    arr = document.getElementById("data_dictionary").getElementsByTagName('li'), data_dictionary = [];
    for (i = 0; i < arr.length; i++) {
        arr_str = arr[i].innerHTML;
        var obj = eval('(' + arr_str + ')');
        data_dictionary.push(obj);
    }

    cluster_embedding_dataset = new Array()
    arr = document.getElementById("cluster_embedding_data").getElementsByTagName('li');
    temp = [];
    for (i = 0; i < arr.length; i++) {
        temp.push(arr[i].innerHTML);
    }
    for (i = 0; i < temp.length; i++) {
        temp1 = temp[i].replace('[', '');
        temp2 = temp1.replace(']', '');
        temp3 = temp2.split(",");
        numArray = temp3.map((value) => {
            return parseFloat(value);
        });
        cluster_embedding_dataset.push(numArray);
    }

    arr = document.getElementById("n_clusters").getElementsByTagName('li');
    temp = arr[0].innerHTML;
    clusters = parseInt(temp);

    indexes = new Array();
    indexes_string = "Samples marked by ID ";
    for (j = 0; j < clusters; j++) {
        each_indexes = [];
        each_indexes_string = '';
        for (i = 0; i < cluster_embedding_dataset.length; i++) {
            if (cluster_embedding_dataset[i][2] == j) {
                each_indexes.push(i);
                each_indexes_string = each_indexes_string + '"' + i + '"' + " ";
            }
        }
        if (each_indexes.length > 10) {
            each_indexes_string = '';
            for (i = 0; i < 10; i++) {
                each_indexes_string = each_indexes_string + '"' + each_indexes[i] + '"' + " ";
            }
            each_indexes_string = each_indexes_string + '...... '
        }
        indexes.push(each_indexes);
        indexes_string = indexes_string + each_indexes_string + 'belongs to the group colored by "' + colors[j] + '" with ' + each_indexes.length + ' members. ';
    }

    cluster_strings = '   We applied the "' + cluster_method + '" cluster analysis.';
    cluster_strings = cluster_strings + 'The dataset can roughly divided as ' + clusters.toString() + ' groups.';
    cluster_strings = cluster_strings + indexes_string;

    embedding_string = '   To better find the feature, we applied "' + embedding_method + '" to show them. ' +
    'The dataset is projected from n-dimensional to two-dimensional';


    attributions_analysis_dataset = new Array()
    arr = document.getElementById("attributions_analysis_data").getElementsByTagName('li');
    temp = [];
    for (i = 0; i < arr.length; i++) {
        temp.push(arr[i].innerHTML);
    }
    for (i = 0; i < temp.length; i++) {
        temp1 = temp[i].replace('[', '');
        temp2 = temp1.replace(']', '');
        temp3 = temp2.split(",");
        numArray = temp3.map((value) => {
            return parseFloat(value);
        });
        attributions_analysis_dataset.push(numArray);
    }

    anomaly_detection_dataset = new Array()
    arr = document.getElementById("anomaly_detection_data").getElementsByTagName('li');
    temp = [];
    for (i = 0; i < arr.length; i++) {
        temp.push(arr[i].innerHTML);
    }
    for (i = 0; i < temp.length; i++) {
        temp1 = temp[i].replace('[', '');
        temp2 = temp1.replace(']', '');
        temp3 = temp2.split(",");
        numArray = temp3.map((value) => {
            return parseFloat(value);
        });
        anomaly_detection_dataset.push(numArray);
    }

    features_dictionary = new Array();
    arr = document.getElementById("features_dictionary").getElementsByTagName('li');
    temp = [];
    for (i = 0; i < arr.length; i++) {
        features_dictionary.push(arr[i].innerHTML);
    }

    no_identifiers_data_dictionary = new Array();
    arr = document.getElementById("no_identifiers_data_dictionary").getElementsByTagName('li');
    for (i = 0; i < arr.length; i++) {
        arr_str = arr[i].innerHTML;
        obj = eval('(' + arr_str + ')');
        no_identifiers_data_dictionary.push(obj)
    }

    var no_identifiers_data_list = new Array();
    arr = document.getElementById('no_identifiers_data_list').getElementsByTagName('li');
    temp = [];
    for (i = 0; i < arr.length; i++) {
        temp.push(arr[i].innerHTML)
    }
    for (i = 0; i < temp.length; i++) {
        temp1 = temp[i].replace('[', '');
        temp2 = temp1.replace(']', '');
        temp3 = temp2.split(",");
        numArray = temp3.map((value) => {
            return parseFloat(value);
        });
        no_identifiers_data_list.push(numArray)
    }

    var no_identifiers_data_list_transform = new Array();
    arr = document.getElementById('no_identifiers_data_list_transform').getElementsByTagName('li');
    temp = [];
    for (i = 0; i < arr.length; i++) {
        temp.push(arr[i].innerHTML)
    }
    for (i = 0; i < temp.length; i++) {
        temp1 = temp[i].replace('[', '');
        temp2 = temp1.replace(']', '');
        temp3 = temp2.split(",");
        numArray = temp3.map((value) => {
            return parseFloat(value);
        });
        no_identifiers_data_list_transform.push(numArray)
    }

    var data_list = new Array();
    arr = document.getElementById('data_list').getElementsByTagName('li');
    temp = [];
    for (i = 0; i < arr.length; i++) {
        temp.push(arr[i].innerHTML)
    }
    for (i = 0; i < temp.length; i++) {
        temp1 = temp[i].replace('[', '');
        temp2 = temp1.replace(']', '');
        temp3 = temp2.split(",");
        numArray = temp3.map((value) => {
            return parseFloat(value);
        });
        data_list.push(numArray)
    }

    arr = document.getElementById("visualization_method").getElementsByTagName('li');
    visualization_method = arr[0].innerHTML;

    nodes = [];
    links = [];
    for(i = 0; i < feature_list.length; i++){
        object = {};
        object.name = feature_list[i];
        object.group = 1;
        nodes.push(object);
        for(j = i + 1; j < feature_list.length; j++){
            if(corr_data[i][j] < -0.4 || corr_data[i][j] > 0.4){
                object = {};
                object.source = i;
                object.target = j;
                object.corr_data = corr_data[i][j];
                links.push(object);
            }
        }
    }
    attributions_analysis_jsondata = {};
    attributions_analysis_jsondata.nodes = nodes;
    attributions_analysis_jsondata.links = links;

    analysis_svgsize = 350;
</script>
<!--attribution-->
<script>
    var color = d3.scale.category20();
    var fisheye = d3.fisheye.circular()
        .radius(150);
    var force = d3.layout.force()
        .nodes(attributions_analysis_jsondata.nodes)   //指定节点数组
        .links(attributions_analysis_jsondata.links)   //指定连线数组
        .charge(-240)
        .linkDistance(function(d, i){
            return (1 - Math.abs(d.corr_data)) * 300;
        })
        .size([analysis_svgsize, analysis_svgsize]);
    var attributions_zoom = d3.behavior.zoom()
        .scaleExtent([0, 20])
        .on("zoom", attributions_zoomed);
    var attributions_svg = d3.select("#analysis_attributions_analysis_svg").append("svg")
        .attr("width", 2*analysis_svgsize)
        .attr("height", analysis_svgsize)
        .attr('id', 'attributions_svg')
        .append('g')
        .call(attributions_zoom)
        .append("g");

    attributions_svg.append("rect")
        .attr("class", "analysis_attributions_analysis_svg_background")
        .attr("width", analysis_svgsize)
        .attr("height", analysis_svgsize)
        .attr('fill', 'none')
        .attr('pointer-events', 'all');

    var n = attributions_analysis_jsondata.nodes.length;

    attributions_analysis_jsondata.nodes.forEach(function(d, i) {
        d.x = analysis_svgsize / n * Math.floor(Math.random()*(n));
        d.y = analysis_svgsize / n * Math.floor(Math.random()*(n));
    });

    force.start();
    for (var i = n; i > 0; --i) force.tick();
    force.stop();

    var ox = 0, oy = 0;
    attributions_analysis_jsondata.nodes.forEach(function(d) { ox += d.x, oy += d.y; });
    ox = ox / n - analysis_svgsize / 2, oy = oy / n - analysis_svgsize / 2;
    attributions_analysis_jsondata.nodes.forEach(function(d) { d.x -= ox, d.y -= oy; });

    var link = attributions_svg.selectAll(".link")
        .data(attributions_analysis_jsondata.links)
        .enter()
        .append("line")
        .attr("class", "link")
        .attr("x1", function(d) { return d.source.x; })
        .attr("y1", function(d) { return d.source.y; })
        .attr("x2", function(d) { return d.target.x; })
        .attr("y2", function(d) { return d.target.y; })
        .style("stroke",function(d){
            if(d.corr_data<0){
                return 'red';
            }
            else{
                return 'green';
            }
        })
        .style("stroke-width", '1.5px')
        .style("stroke-opacity", '0.6');

    var node = attributions_svg.selectAll(".node")
        .data(attributions_analysis_jsondata.nodes)
        .enter().append("circle")
        .attr("class", "node")
        .attr("cx", function(d) { return d.x; })
        .attr("cy", function(d) { return d.y; })
        .attr("r", 5)
        .style("fill", function(d) { return color(d.group); })
        .call(force.drag)
        .attr('stroke', '#fff')
        .attr('stroke-width', '1.5px');

    var svg_texts = attributions_svg.append("g").selectAll("text")
        .data(attributions_analysis_jsondata.nodes)
        .enter()
        .append("text")
        .style("fill", "black")
        .attr('font-size', '7')
        .attr("dx", 0)
        .attr("dy", 0)
        .text(function(d){
            return d.name;
        })
        .attr("x", function(d){ return d.x; })
            .attr("y", function(d){ return d.y; });

    attributions_svg.on("mousemove", function() {
        fisheye.focus(d3.mouse(this));
        node.each(function(d) { d.fisheye = fisheye(d); })
            .attr("cx", function(d) { return d.fisheye.x; })
            .attr("cy", function(d) { return d.fisheye.y; })
            .attr("r", function(d) { return d.fisheye.z * 5; });

        svg_texts.attr("x", function(d){ return d.fisheye.x; })
            .attr("y", function(d){ return d.fisheye.y; });

        link.attr("x1", function(d) { return d.source.fisheye.x; })
            .attr("y1", function(d) { return d.source.fisheye.y; })
            .attr("x2", function(d) { return d.target.fisheye.x; })
            .attr("y2", function(d) { return d.target.fisheye.y; });
    });

    attributions_svg.append('rect')
        .attr('x', analysis_svgsize - 80)
        .attr('y', 20)
         .attr('width', 10)
         .attr('height', 10)
          .attr('fill', 'red');
    attributions_svg.append('text')
          .attr('x', analysis_svgsize - 70)
         .attr('y', 30)
         .text('negative');

    attributions_svg.append('rect')
         .attr('x', analysis_svgsize - 80)
         .attr('y', 50)
         .attr('width', 10)
         .attr('height', 10)
        .attr('fill', 'green');
    attributions_svg.append('text')
        .attr('x', analysis_svgsize - 70)
        .attr('y', 60)
        .text('positive');


     function attributions_zoomed() {
        attributions_svg.attr("transform", "translate(" + attributions_zoom.translate() + ")" + "scale(" + attributions_zoom.scale() + ")");
    }

    var serializer = new XMLSerializer();
    var attributions_source = serializer.serializeToString(document.getElementById('attributions_svg'));
    attributions_source = '<?xml version="1.0" standalone="no"?>\r\n' + attributions_source;
    var attributions_url = "data:image/svg+xml;charset=utf-8," + encodeURIComponent(attributions_source);
    var attributions_canvas = document.createElement("canvas");
    attributions_canvas.width = analysis_svgsize;
    attributions_canvas.height = analysis_svgsize;
    var attributions_context = attributions_canvas.getContext("2d");
    var attributions_image = new Image;
    attributions_image.src = attributions_url;
    attributions_image.onload = function () {
        attributions_context.drawImage(attributions_image, 0, 0);
        attributions_svg_url = attributions_canvas.toDataURL("image/png");
    };
</script>
<!--cluster-->
<script type="text/javascript">
    svg_size = 350;
    var padding = 5;
    var brushcell = undefined;
    cx_max = d3.max(cluster_embedding_dataset, function (d) {return d[0];});
    cx_min = d3.min(cluster_embedding_dataset, function (d) {return d[0];});
    cy_max = d3.max(cluster_embedding_dataset, function (d) {return d[1];});
    cy_min = d3.min(cluster_embedding_dataset, function (d) {return d[1];});
    cmax = cx_max > cy_max ? cx_max : cy_max;
    cmin = cx_min < cy_min ? cx_min : cy_min;
    var xScale = d3.scale.linear()
        .domain([cmin, cmax])
        .range([padding, svg_size - padding]);
    var yScale = d3.scale.linear()
        .domain([cmin, cmax])
        .range([svg_size - padding, padding]);
    var cluster_zoom = d3.behavior.zoom()
        .scaleExtent([0, 20])
        .on("zoom", cluster_zoomed);
    cluster_svg = d3.select("#analysis_cluster_embedding_svg")       //create svg
        .append('svg')
        .attr('id', 'cluster_svg')
        .attr('width', 2*svg_size)
        .attr('height', svg_size)
        .append("g")
        .call(cluster_zoom)
        .append("g");
    cluster_svg.append('rect')
        .attr("width", svg_size)
        .attr("height", svg_size)
        .attr('fill', 'none')
        .attr('pointer-events', 'all');

    circles = cluster_svg.selectAll('circle')
        .data(cluster_embedding_dataset)
        .enter()
        .append('circle')
        .attr("transform", function(d) { return "translate(" + xScale(d[0]) + "," + yScale(d[1]) + ")"; })
        .style('stroke', 'white')
        .attr('r', 4)
        .style('fill', function (d) {
            return d3Colors(d[2])
        })
        .data(data_dictionary)
        .on("mouseover", function (d, i) {
            key_name = new Array();
            for (var key in d) {
                key_value = key + ':' + d[key];
                key_name.push(key_value)
            }
            table = key_name.toString();
            table_n = table.replace(/,/g, '\n');
            cluster_svg.append("title").text('ID:' + i + "\n" + table_n).attr("id", "Ttitle");
            d3.select(this)
                .attr("r", 8);
        })
        .on("mouseout", function (d) {
            d3.select(this)
                .attr("r", 4);
            d3.select("#Ttitle").remove();
        });

    var serializer = new XMLSerializer();
    var cluster_source = serializer.serializeToString(document.getElementById('cluster_svg'));
    cluster_source = '<?xml version="1.0" standalone="no"?>\r\n' + cluster_source;
    var cluster_url = "data:image/svg+xml;charset=utf-8," + encodeURIComponent(cluster_source);
    var cluster_canvas = document.createElement("canvas");
    cluster_canvas.width = svg_size;
    cluster_canvas.height = svg_size;
    var cluster_context = cluster_canvas.getContext("2d");
    var cluster_image = new Image;
    cluster_image.src = cluster_url;
    cluster_image.onload = function () {
        cluster_context.drawImage(cluster_image, 0, 0);
        cluster_svg_url = cluster_canvas.toDataURL("image/png");
    };

    function cluster_zoomed() {
        cluster_svg.attr("transform", "translate(" + cluster_zoom.translate() + ")" + "scale(" + cluster_zoom.scale() + ")");
    }
</script>
<!--anomaly-->
<script>
    svg_size = 350;
    var padding = 5;
    var brushcell = undefined;
    cx_max = d3.max(cluster_embedding_dataset, function (d) {return d[0];});
    cx_min = d3.min(cluster_embedding_dataset, function (d) {return d[0];});
    cy_max = d3.max(cluster_embedding_dataset, function (d) {return d[1];});
    cy_min = d3.min(cluster_embedding_dataset, function (d) {return d[1];});
    cmax = cx_max > cy_max ? cx_max : cy_max;
    cmin = cx_min < cy_min ? cx_min : cy_min;
    var xScale = d3.scale.linear()
        .domain([cmin, cmax])
        .range([padding, svg_size - padding]);
    var yScale = d3.scale.linear()
        .domain([cmin, cmax])
        .range([svg_size - padding, padding]);
    var anomaly_zoom = d3.behavior.zoom()
        .scaleExtent([0, 20])
        .on("zoom", anomaly_zoomed);
    var anomaly_svg = d3.select("#analysis_anomaly_detection_svg").append("svg")
        .attr("width", 2*analysis_svgsize)
        .attr("height", analysis_svgsize)
        .attr('id', 'anomaly_svg')
        .append('g')
        .call(anomaly_zoom)
        .append("g");
    anomaly_svg.append('rect')
        .classed("frame", true)
        .attr("width", svg_size)
        .attr("height", svg_size)
        .attr('fill', 'none')
        .attr('pointer-events', 'all');
    circles = anomaly_svg.selectAll('circle')
        .data(anomaly_detection_dataset)
        .enter()
        .append('circle')
        .attr('cx', function (d) {
            return xScale(d[0]);
        })
        .attr('cy', function (d) {
            return yScale(d[1]);
        })
        .style('stroke', 'white')
        .attr('r', 4)
        .style('fill', function (d) {
            return d3Colors(d[2]);
        });

    function anomaly_zoomed() {
        anomaly_svg.attr("transform", "translate(" + anomaly_zoom.translate() + ")" + "scale(" + anomaly_zoom.scale() + ")");
    }

    var serializer = new XMLSerializer();
    var anomaly_source = serializer.serializeToString(document.getElementById('anomaly_svg'));
    anomaly_source = '<?xml version="1.0" standalone="no"?>\r\n' + anomaly_source;
    var anomaly_url = "data:image/svg+xml;charset=utf-8," + encodeURIComponent(anomaly_source);
    var anomaly_canvas = document.createElement("canvas");
    anomaly_canvas.width = svg_size;
    anomaly_canvas.height = svg_size;
    var anomaly_context = anomaly_canvas.getContext("2d");
    var anomaly_image = new Image;
    anomaly_image.src = anomaly_url;
    anomaly_image.onload = function () {
        anomaly_context.drawImage(anomaly_image, 0, 0);
        anomaly_svg_url = anomaly_canvas.toDataURL("image/png");
    };
    </script>
<!--classification-->
<script>
</script>
<!--regression-->
<script>
</script>
<!--visualization-->
<script>
    document.getElementById('one').addEventListener('click', function () {
        if(d3.select('#scatter_svg')){
            d3.select('#scatter_svg').remove();
        }
        if(d3.select('#parallel_svg')){
            d3.select('#parallel_svg').remove();
        }
        draw_radviz();
    });

    document.getElementById('two').addEventListener('click', function () {
        if(d3.select('#radviz_svg')){
            d3.select('#radviz_svg').remove();
        }
        if(d3.select('#parallel_svg')){
            d3.select('#parallel_svg').remove();
        }
        draw_scatter();
    });

    document.getElementById('three').addEventListener('click', function () {
        if(d3.select('#radviz_svg')){
            d3.select('#radviz_svg').remove();
        }
        if(d3.select('#scatter_svg')){
            d3.select('#scatter_svg').remove();
        }
        draw_parallel();
    });

    draw_parallel();

    var serializer = new XMLSerializer();
    var radviz_source = serializer.serializeToString(document.getElementById('parallel_svg'));
    radviz_source = '<?xml version="1.0" standalone="no"?>\r\n' + radviz_source;
    var radviz_url = "data:image/svg+xml;charset=utf-8," + encodeURIComponent(radviz_source);
    var radviz_canvas = document.createElement("canvas");
    radviz_canvas.width = 1200;
    radviz_canvas.height = 400;
    var radviz_context = radviz_canvas.getContext("2d");
    var radviz_image = new Image;
    radviz_image.src = radviz_url;
    radviz_image.onload = function () {
        radviz_context.drawImage(radviz_image, 0, 0);
        radviz_svg_url = radviz_canvas.toDataURL("image/png");
    };
</script>
<!--report-->
<script>
    function download_report() {
        var type = "docx";
        var data = {
            title: "The Analysis Report",
            clean: "1. Clean",
            clean_content: "   There is no missing value.",
            statistics: "2. Statistics Analysis",
            statistics_content: statistics_strings,
            attributes: "3. Attributes Analysis(Correlation Plot, Causality)",
            attributions_img: attributions_svg_url,
            attributes_content: attributes_string,
            cluster: "4. Cluster Analysis (k-means by default)",
            cluster_img: cluster_svg_url,
            cluster_content: cluster_strings,
            outlier: "5. Outlier Detection",
            outlier_img: anomaly_svg_url,
            outlier_content: "  We also detected some outliers. There is no outlier.",
            projection: "6. Feature Projection (PCA by default)",
            projection_content: embedding_string,
            contextual: "7. Contextual Analysis (Parallel Coordinates)",
            contextual_img: radviz_svg_url,
            contextual_content: "   Finally, we applied Parallel Coordinates to detect the relations between samples and attributes."
        };
        XDoc.to(baidu.template('report_tmpl', data), type, {});
    }
</script>
<script id="report_tmpl" type="text/html">
    <xdoc version="A.3.0">
        <body>
        <para>
            <text class="report_head" fontName="Calibri" fontSize="30"><%=title%></text>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="20"><%=clean%></text>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="14"><%=clean_content%></text>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="20"><%=statistics%></text>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="14"><%=statistics_content%></text>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="20"><%=attributes%></text>
        </para>
        <para>
            <img src="<%=attributions_img%>" sizeType="autosize"/>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="14"><%=attributes_content%></text>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="20"><%=cluster%></text>
        </para>
        <para>
            <img src="<%=cluster_img%>" sizeType="autosize"/>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="14"><%=cluster_content%></text>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="20"><%=outlier%></text>
        </para>
        <para>
            <img src="<%=outlier_img%>" sizeType="autosize"/>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="14"><%=outlier_content%></text>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="20"><%=projection%></text>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="14"><%=projection_content%></text>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="20"><%=contextual%></text>
        </para>
        <para>
            <img src="<%=contextual_img%>" sizeType="autosize"/>
        </para>
        <para>
            <text class="report_content" fontName="Calibri" fontSize="14"><%=contextual_content%></text>
        </para>
        </body>
    </xdoc>
</script>

</body>
</html>